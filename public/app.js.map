{
  "version": 3,
  "sources": ["app.ts"],
  "sourcesContent": ["// Type definitions\ninterface Employee {\n    id: number;\n    name: string;\n    identifier: string;\n    ptoRate: number;\n    carryoverHours: number;\n    role: string;\n    hash: string;\n}\n\ninterface PTOEntry {\n    id: number;\n    employeeId: number;\n    startDate: string;\n    endDate: string;\n    type: string;\n    hours: number;\n    createdAt: string;\n}\n\ninterface PTOStatus {\n    available: number;\n    used: number;\n    remaining: number;\n}\n\n// API client\nclass APIClient {\n    private baseURL = \"/api\";\n\n    async get(endpoint: string): Promise<any> {\n        const response = await fetch(`${this.baseURL}${endpoint}`);\n        return response.json();\n    }\n\n    async post(endpoint: string, data: any): Promise<any> {\n        const response = await fetch(`${this.baseURL}${endpoint}`, {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n            },\n            body: JSON.stringify(data),\n        });\n        return response.json();\n    }\n}\n\nconst api = new APIClient();\n\n// UI Manager\nclass UIManager {\n    private currentUser: Employee | null = null;\n\n    constructor() {\n        this.init();\n    }\n\n    private init(): void {\n        this.checkAuth();\n        this.setupEventListeners();\n    }\n\n    private async checkAuth(): Promise<void> {\n        // Check URL params for magic link\n        const urlParams = new URLSearchParams(window.location.search);\n        const token = urlParams.get('token');\n        const ts = urlParams.get('ts');\n        if (token && ts) {\n            try {\n                const response = await api.get(`/auth/validate?token=${token}&ts=${ts}`);\n                this.setAuthCookie(response.publicHash);\n                localStorage.setItem('currentUser', JSON.stringify(response.employee));\n                this.currentUser = response.employee;\n                this.showDashboard();\n                await this.loadPTOStatus();\n                // Clean URL\n                window.history.replaceState({}, document.title, window.location.pathname);\n                return;\n            } catch (error) {\n                alert('Invalid or expired magic link.');\n            }\n        }\n\n        // Check cookie\n        const cookieHash = this.getAuthCookie();\n        if (cookieHash) {\n            const storedUser = localStorage.getItem('currentUser');\n            if (storedUser) {\n                this.currentUser = JSON.parse(storedUser);\n                this.showDashboard();\n                await this.loadPTOStatus();\n                return;\n            }\n        }\n\n        this.showLogin();\n    }\n\n    private setAuthCookie(hash: string): void {\n        document.cookie = `auth_hash=${hash}; path=/; max-age=31536000`; // 1 year\n    }\n\n    private getAuthCookie(): string | null {\n        const cookies = document.cookie.split(';');\n        for (const cookie of cookies) {\n            const [name, value] = cookie.trim().split('=');\n            if (name === 'auth_hash') {\n                return value;\n            }\n        }\n        return null;\n    }\n\n    private setupEventListeners(): void {\n        // Login form\n        const loginForm = document.getElementById(\"login-form\") as HTMLFormElement;\n        loginForm.addEventListener(\"submit\", (e) => this.handleLogin(e));\n\n        // PTO form\n        const ptoForm = document.getElementById(\n            \"pto-entry-form\",\n        ) as HTMLFormElement;\n        ptoForm.addEventListener(\"submit\", (e) => this.handlePTO(e));\n\n        const cancelBtn = document.getElementById(\n            \"cancel-pto\",\n        ) as HTMLButtonElement;\n        cancelBtn.addEventListener(\"click\", () => this.showDashboard());\n\n        // Logout\n        const logoutBtn = document.getElementById(\"logout-btn\") as HTMLButtonElement;\n        logoutBtn.addEventListener(\"click\", () => this.handleLogout());\n\n        // Navigation\n        const newPTOBtn = document.getElementById(\n            \"new-pto-btn\",\n        ) as HTMLButtonElement;\n        newPTOBtn.addEventListener(\"click\", () => this.showPTOForm());\n\n        // Admin buttons\n        const manageBtn = document.getElementById(\n            \"manage-employees-btn\",\n        ) as HTMLButtonElement;\n        manageBtn.addEventListener(\"click\", () => this.showEmployeeManagement());\n\n        const reportsBtn = document.getElementById(\n            \"view-reports-btn\",\n        ) as HTMLButtonElement;\n        reportsBtn.addEventListener(\"click\", () => this.showReports());\n    }\n\n    private handleLogout(): void {\n        this.currentUser = null;\n        document.cookie = 'auth_hash=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT';\n        localStorage.removeItem('currentUser');\n        this.showLogin();\n    }\n\n    private async handleLogin(e: Event): Promise<void> {\n        e.preventDefault();\n        const identifier = (\n            document.getElementById(\"identifier\") as HTMLInputElement\n        ).value;\n\n        try {\n            const response = await api.post(\"/auth/request-link\", { identifier });\n            const messageDiv = document.getElementById(\"login-message\")!;\n            messageDiv.textContent = response.message;\n            messageDiv.classList.remove(\"hidden\");\n        } catch (error) {\n            alert(\"Failed to send magic link. Please try again.\");\n        }\n    }\n\n    private async handlePTO(e: Event): Promise<void> {\n        e.preventDefault();\n        if (!this.currentUser) return;\n\n        const startDate = (\n            document.getElementById(\"start-date\") as HTMLInputElement\n        ).value;\n        const endDate = (document.getElementById(\"end-date\") as HTMLInputElement)\n            .value;\n        const type = (document.getElementById(\"pto-type\") as HTMLSelectElement)\n            .value;\n        const hours = parseFloat(\n            (document.getElementById(\"hours\") as HTMLInputElement).value,\n        );\n\n        try {\n            await api.post(\"/pto\", {\n                employeeId: this.currentUser.id,\n                startDate,\n                endDate,\n                type,\n                hours,\n            });\n\n            alert(\"PTO submitted successfully!\");\n            this.showDashboard();\n            await this.loadPTOStatus();\n        } catch (error) {\n            alert(\"Failed to submit PTO. Please try again.\");\n        }\n    }\n\n    private showLogin(): void {\n        this.hideAllSections();\n        document.getElementById(\"login-section\")!.classList.remove(\"hidden\");\n        document.getElementById(\"logout-btn\")!.classList.add(\"hidden\");\n    }\n\n    private showDashboard(): void {\n        this.hideAllSections();\n        document.getElementById(\"dashboard\")!.classList.remove(\"hidden\");\n        if (this.currentUser?.role === \"Admin\") {\n            document.getElementById(\"admin-panel\")!.classList.remove(\"hidden\");\n        }\n        document.getElementById(\"logout-btn\")!.classList.remove(\"hidden\");\n    }\n\n    private showPTOForm(): void {\n        this.hideAllSections();\n        document.getElementById(\"pto-form\")!.classList.remove(\"hidden\");\n    }\n\n    private showEmployeeManagement(): void {\n        // TODO: Implement employee management UI\n        alert(\"Employee management coming soon!\");\n    }\n\n    private showReports(): void {\n        // TODO: Implement reports UI\n        alert(\"Reports coming soon!\");\n    }\n\n    private hideAllSections(): void {\n        const sections = [\"login-section\", \"dashboard\", \"pto-form\", \"admin-panel\"];\n        sections.forEach((id) => {\n            document.getElementById(id)!.classList.add(\"hidden\");\n        });\n    }\n\n    private async loadPTOStatus(): Promise<void> {\n        if (!this.currentUser) return;\n\n        try {\n            // TODO: Implement PTO status calculation\n            const status: PTOStatus = {\n                available: 80,\n                used: 16,\n                remaining: 64,\n            };\n\n            const statusDiv = document.getElementById(\"pto-status\")!;\n            statusDiv.innerHTML = `\n                <h3>Your PTO Status</h3>\n                <p>Available: ${status.available} hours</p>\n                <p>Used: ${status.used} hours</p>\n                <p>Remaining: ${status.remaining} hours</p>\n            `;\n        } catch (error) {\n            console.error(\"Failed to load PTO status:\", error);\n        }\n    }\n}\n\n// Initialize the application\nnew UIManager();\n"],
  "mappings": "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",
  "names": []
}
