<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PTO Calendar Component Test</title>
    <link rel="stylesheet" href="/styles.css" />
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
        color: var(--color-text);
        background: var(--color-background);
      }
      .test-controls {
        margin: 20px 0;
        padding: 10px;
        border: 1px solid var(--color-border);
        background: var(--color-surface);
      }
      .test-controls button {
        margin: 5px;
        padding: 8px 16px;
        background: var(--color-primary);
        color: var(--color-on-primary);
        border: none;
        border-radius: 4px;
      }
      .status {
        margin: 10px 0;
        padding: 10px;
        background: var(--color-surface);
        border: 1px solid var(--color-border);
        color: var(--color-text);
      }
    </style>
  </head>
  <body>
    <h1>PTO Calendar Component Test</h1>

    <div
      class="instructions"
      style="
        margin: 20px 0;
        padding: 20px;
        background: var(--color-primary-light);
        border: 4px solid var(--color-primary);
        border-radius: 4px;
        color: var(--color-text);
      "
    >
      <h3>How to Test Interactive PTO Request Creation:</h3>
      <ol>
        <li>
          <strong>Test theming:</strong> Click "Toggle Theme" to switch between
          light and dark modes
        </li>
        <li>
          <strong>Make calendar editable:</strong> Click "Toggle Readonly Mode"
          to enable editing
        </li>
        <li>
          <strong>Select PTO type:</strong> Click on a legend item below the
          calendar (PTO, Sick, etc.)
        </li>
        <li>
          <strong>Paint cells:</strong> Click on weekday cells (Mon-Fri) to
          apply the selected PTO type
        </li>
        <li>
          <strong>Edit hours:</strong> Click on the hours number in painted
          cells to change the hours
        </li>
        <li>
          <strong>Submit request:</strong> Click "Submit PTO Request" to submit
          your selections
        </li>
      </ol>
      <p>
        <em
          >Note: Weekend cells (Sat/Sun) cannot be selected. Existing PTO
          entries are shown in color. Theme switching should work
          seamlessly.</em
        >
      </p>
    </div>

    <div class="test-controls">
      <h3>Test Controls</h3>
      <button id="toggle-theme">Toggle Theme (Light/Dark)</button>
      <button id="toggle-readonly">Toggle Readonly Mode</button>
      <button id="clear-selection">Clear Selection</button>
      <button id="get-selected">Get Selected Requests</button>
      <div id="status" class="status">
        Status: Calendar is in editable mode - try clicking a legend item then
        painting cells!
      </div>
    </div>

    <div
      id="test-output"
      style="
        display: grid;
        gap: 12px;
        padding: 10px;
        border: 1px solid var(--color-border);
        margin: 10px 0;
        background: var(--color-surface);
      "
    >
      <!-- Calendar component will be inserted here by the playground function -->
    </div>

    <!-- Submit button for the calendar -->
    <button
      id="submit-pto"
      style="
        margin: 10px;
        padding: 10px 20px;
        background: var(--color-primary);
        color: var(--color-on-primary);
        border: none;
        border-radius: 4px;
      "
    >
      Submit PTO Request
    </button>

    <script type="module">
      import { ptoCalendar } from "/app.js";
      const output = document.getElementById("test-output");
      const status = document.getElementById("status");

      // Get the calendar component
      const calendarContainer = ptoCalendar();
      output.appendChild(calendarContainer);

      const calendar = calendarContainer.querySelector("pto-calendar");

      // Assign submit button to the calendar's submit slot
      const submitButton = document.getElementById("submit-pto");
      submitButton.setAttribute("slot", "submit");
      calendar.appendChild(submitButton);

      // Add click handler to the submit button
      submitButton.addEventListener("click", () => {
        calendar.submitRequest();
      });

      // Add event listener for PTO request submission
      calendar.addEventListener("pto-request-submit", (e) => {
        status.textContent = `Status: PTO Request Submitted - ${e.detail.requests.length} requests`;
        console.log("PTO Request:", e.detail.requests);
      });

      // Test controls
      document.getElementById("toggle-theme").addEventListener("click", () => {
        const currentTheme =
          document.documentElement.getAttribute("data-theme");
        const newTheme = currentTheme === "dark" ? "light" : "dark";
        document.documentElement.setAttribute("data-theme", newTheme);
        status.textContent = `Status: Switched to ${newTheme} theme`;
      });

      document
        .getElementById("toggle-readonly")
        .addEventListener("click", () => {
          const isReadonly = calendar.getAttribute("readonly") === "true";
          calendar.setReadonly(!isReadonly);
          status.textContent = `Status: Calendar is now in ${!isReadonly ? "readonly" : "editable"} mode`;
        });

      document
        .getElementById("clear-selection")
        .addEventListener("click", () => {
          calendar.clearSelection();
          status.textContent = "Status: Selection cleared";
        });

      document.getElementById("get-selected").addEventListener("click", () => {
        const requests = calendar.getSelectedRequests();
        status.textContent = `Status: ${requests.length} requests selected`;
        console.log("Selected requests:", requests);
      });
    </script>
  </body>
</html>
