<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PTO Dashboard Components Test</title>
    <link rel="stylesheet" href="../../styles.css" />
    <style>
      .request-mode-indicator {
        background: #e8f4fd;
        border: 2px solid #007bff;
        border-radius: 8px;
        padding: 16px;
        margin: 16px 0;
        text-align: center;
        font-weight: bold;
        color: #007bff;
      }
      .submission-log {
        background: #f8f9fa;
        border: 1px solid #dee2e6;
        border-radius: 4px;
        padding: 12px;
        margin: 16px 0;
        font-family: monospace;
        white-space: pre-wrap;
      }
      .workflow-instructions {
        background: #fff3cd;
        border: 1px solid #ffeaa7;
        border-radius: 4px;
        padding: 12px;
        margin: 16px 0;
      }
    </style>
  </head>
  <body>
    <h1>PTO Dashboard Components Test</h1>

    <div class="request-mode-indicator">
      üîÑ PTO REQUEST MODE ENABLED - Interactive Calendar Testing
    </div>

    <div class="workflow-instructions">
      <strong>Testing Workflow:</strong>
      1. Click a month button (‚úèÔ∏è) in the accrual card to select a month 2.
      Click a PTO type in the calendar legend to select it 3. Click weekday
      cells to "paint" them with the selected PTO type 4. Edit hours in the
      bottom-right corner of selected cells (default: 8) 5. Click "Submit PTO
      Request" to see the submission data
    </div>

    <div
      id="test-output"
      style="
        display: grid;
        gap: 12px;
        padding: 10px;
        border: 1px solid #ccc;
        margin: 10px 0;
      "
    >
      <pto-summary-card></pto-summary-card>
      <pto-accrual-card
        request-mode="true"
        annual-allocation="96"
        accruals='[{"month": 1, "hours": 8.0}, {"month": 2, "hours": 7.2}]'
        usage='[{"month": 1, "hours": 4.0}, {"month": 2, "hours": 2.0}]'
        pto-entries='[{"id": 1, "employeeId": 1, "date": "2026-02-13", "type": "Sick", "hours": 8, "createdAt": "2026-01-01"}, {"id": 2, "employeeId": 1, "date": "2026-02-15", "type": "Sick", "hours": 8, "createdAt": "2026-01-01"}, {"id": 3, "employeeId": 1, "date": "2026-02-17", "type": "Sick", "hours": 8, "createdAt": "2026-01-01"}, {"id": 4, "employeeId": 1, "date": "2026-02-21", "type": "PTO", "hours": 8, "createdAt": "2026-01-01"}, {"id": 5, "employeeId": 1, "date": "2026-02-23", "type": "PTO", "hours": 8, "createdAt": "2026-01-01"}, {"id": 6, "employeeId": 1, "date": "2026-02-25", "type": "PTO", "hours": 8, "createdAt": "2026-01-01"}]'
        year="2026"
      >
      </pto-accrual-card>
      <pto-sick-card></pto-sick-card>
      <pto-bereavement-card></pto-bereavement-card>
      <pto-jury-duty-card></pto-jury-duty-card>
      <pto-employee-info-card></pto-employee-info-card>
    </div>

    <div class="submission-log" id="submission-log">
      <strong>PTO Request Submissions:</strong>
      (No submissions yet)
    </div>

    <script type="module">
      import { ptoDashboard } from "/app.js";

      // Initialize dashboard
      ptoDashboard();

      // Mock submission handler
      function handlePtoRequestSubmit(event) {
        console.log("PTO Request Submit Event Received:", event);
        console.log("Event detail:", event.detail);
        const { requests } = event.detail;
        console.log("Requests:", requests);
        const logElement = document.getElementById("submission-log");

        const timestamp = "Test Time";
        const submissionText = `
[${timestamp}] PTO Request Submitted:
${requests.map((req) => `  - ${req.date}: ${req.hours} hours (${req.type})`).join("\n")}

Total Requests: ${requests.length}
`;

        logElement.textContent += submissionText;

        // Visual feedback
        logElement.style.background = "#d4edda";
        logElement.style.borderColor = "#c3e6cb";
        setTimeout(() => {
          logElement.style.background = "#f8f9fa";
          logElement.style.borderColor = "#dee2e6";
        }, 2000);
      }

      // Listen for PTO request submissions from the accrual card
      document.addEventListener("pto-request-submit", handlePtoRequestSubmit);
      console.log("Event listener added for pto-request-submit");

      // Add some helpful logging for testing
      console.log("PTO Request Test Page Loaded");
      console.log(
        "Instructions: Select a month, choose PTO type, paint cells, edit hours, submit",
      );
    </script>
  </body>
</html>
